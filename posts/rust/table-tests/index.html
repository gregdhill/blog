<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="UTF-8">
	<meta name="description" content="Interested in Blockchains, Cryptography and Distributed Systems.">
	<meta name="keywords" content="computer, security, ethical hacker, researcher, inventor, abertay, dundee, edinburgh, machine learning, mathematics, cryptography, blockchains, reverse engineering, linux, programming, scotland, greg hill">
	<meta name="author" content="Gregory Hill">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gregory Hill</title>
	<link href="/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/style.css" rel="stylesheet">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="img/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="img/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/img/manifest.json">
	<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
	<link rel="shortcut icon" href="/img/favicon.ico">
	<meta name="msapplication-config" content="/img/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
</head><body>
    <main><div class="post">
    <div class="post-info">
        
            Oct 6, 2019
            · 181 words
            · 1 minute read
        
    </div>

    <h1 class="post-title">
        Table Driven Tests
    </h1>

    <div class="post-tags"><a class="tag" href=/tags/rust/>#rust</a></div>

    <p>One of my favorite ways to write tests in Go is with a table driven test. If you are unfamiliar
with the concept check out the <a href="https://dave.cheney.net/2013/06/09/writing-table-driven-tests-in-go">excellent Dave Cheney post</a>.
If you need to unit test a component under a multitude of edge cases, then this is good technique to adopt.
Anyway, I&rsquo;m learning Rust in my spare time so I thought I&rsquo;d best give it a go. Hopefully this will suffice, but if you
think it could be improved please hit me up on <a href="https://twitter.com/gregorydhill">twitter</a>.</p>
<p>Following in Dave&rsquo;s footsteps, let&rsquo;s implement a recursive function to calculate the
<a href="https://en.wikipedia.org/wiki/Fibonacci_number">fibonacci number</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span>: <span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i64</span> <span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></div><p>For the structure itself we&rsquo;ll need to define a <code>struct</code> which details our required
input(s) - in this case <code>n</code> - and our expected result (<code>e</code>). We can then iterate over
an array of these test cases, using the macro <code>assert_eq!</code> to ensure the computed
result matches.</p>
<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="cp">#[test]</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">table</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">struct</span> <span class="nc">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">n</span>: <span class="kt">i64</span><span class="p">,</span><span class="w">
</span><span class="w">        </span><span class="n">e</span>: <span class="kt">i64</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fib_tests</span>: <span class="p">[</span><span class="n">Pair</span><span class="p">;</span><span class="w"> </span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">2</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">3</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">2</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">4</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">3</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">5</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">5</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">6</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">8</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">7</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">13</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">    </span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">fib_tests</span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">n</span><span class="p">))</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></div><p>See the <a href="https://doc.rust-lang.org/rust-by-example/testing/unit_testing.html">docs</a> for
more information on unit testing in Rust!</p>

</div></main>
</body>

</html>