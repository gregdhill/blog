<!DOCTYPE html>
<html lang="en-gb">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Table Driven Tests &middot; Greg Hill</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/fonts.css">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Greg Hill" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Greg Hill</h2>
				</a>
				<ul>
    
    
        <li>
            <a href="/posts/">
                
                <span>Posts</span>
                
            </a>
        </li>
    
        <li>
            <a href="/projects/">
                
                <span>Projects</span>
                
            </a>
        </li>
    
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        Gregory Hill
        <br>
        <span>on&nbsp;</span><time datetime="2019-10-06 00:00:00 &#43;0000 UTC">October 6, 2019</time>
</div>
		<h1 class="post-title">Table Driven Tests</h1>
<div class="post-line"></div>

		

		<p>One of my favorite ways to write tests in Go is with a table driven test. If you are unfamiliar
with the concept check out the <a href="https://dave.cheney.net/2013/06/09/writing-table-driven-tests-in-go">excellent Dave Cheney post</a>.
If you need to unit test a component under a multitude of edge cases, then this is good technique to adopt.
Anyway, I&rsquo;m learning Rust in my spare time so I thought I&rsquo;d best give it a go. Hopefully this will suffice, but if you
think it could be improved please hit me up on <a href="https://twitter.com/gregorydhill">twitter</a>.</p>
<p>Following in Dave&rsquo;s footsteps, let&rsquo;s implement a recursive function to calculate the
<a href="https://en.wikipedia.org/wiki/Fibonacci_number">fibonacci number</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span>: <span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i64</span> <span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></div><p>For the structure itself we&rsquo;ll need to define a <code>struct</code> which details our required
input(s) - in this case <code>n</code> - and our expected result (<code>e</code>). We can then iterate over
an array of these test cases, using the macro <code>assert_eq!</code> to ensure the computed
result matches.</p>
<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="cp">#[test]</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">table</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">struct</span> <span class="nc">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">n</span>: <span class="kt">i64</span><span class="p">,</span><span class="w">
</span><span class="w">        </span><span class="n">e</span>: <span class="kt">i64</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fib_tests</span>: <span class="p">[</span><span class="n">Pair</span><span class="p">;</span><span class="w"> </span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">2</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">3</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">2</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">4</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">3</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">5</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">5</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">6</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">8</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">        </span><span class="n">Pair</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">n</span>: <span class="mi">7</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">e</span>: <span class="mi">13</span><span class="p">,</span><span class="w"> 
</span><span class="w">        </span><span class="p">},</span><span class="w">
</span><span class="w">    </span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">fib_tests</span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">fib</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">n</span><span class="p">))</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></div><p>See the <a href="https://doc.rust-lang.org/rust-by-example/testing/unit_testing.html">docs</a> for
more information on unit testing in Rust!</p>


		
	</div>

	<div class="pagination">
		<a href="/posts/ethereum/erc-tokens/" class="left arrow">&#8592;</a>
		<a href="/posts/bitcoin/pow_explained/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2020-04-07 16:25:22.44161904 &#43;0100 BST m=&#43;0.054004140">2020</time> Greg Hill. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
